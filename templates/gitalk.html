{- with site.gitalk -}
{- if .enable -}

<div id="gitalk-container"></div>

<div 
data-client-id="{: .client_id :}"
data-client-secret="{: .client_secret :}"
data-repo="{: .repo :}"
data-owner="{: .owner :}"
data-admin="{: .admin :}" 
{- with .title -} data-title="{: this :}" {- end -} 
{- with .language -} data-language="{: this :}" {- end -}  
id="gitalk-data">
</div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
    var gitalkData = document.getElementById('gitalk-data');
    var gitalk = new Gitalk({
        clientID: gitalkData.getAttribute('data-client-id').trim(),
        clientSecret: gitalkData.getAttribute('data-client-secret').trim(),
        repo: gitalkData.getAttribute('data-repo').trim(),
        owner: gitalkData.getAttribute('data-owner').trim(),
        admin: [gitalkData.getAttribute('data-admin').trim()],
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: false,  // Facebook-like distraction
        title: gitalkData.getAttribute('data-title') ? gitalkData.getAttribute('data-title').trim() : undefined,
        language: gitalkData.getAttribute('data-language') ? gitalkData.getAttribute('data-language').trim() : undefined,
    });

    console.log("Gitalk initialized:", gitalk);

    gitalk.render('gitalk-container')
</script>

{- end -}
{- end -}